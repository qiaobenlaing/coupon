<layout name="layout_admin" />
<script src="__PUBLIC__/js/knockout.js" charset="UTF-8"></script>
<script src="__PUBLIC__/js/webuploader.js" charset="UTF-8"></script>
<script src="__PUBLIC__/js/upload.js" charset="UTF-8"></script>
<script src="__PUBLIC__/shop/set.js" charset="UTF-8"></script>
<link rel="stylesheet" href="__PUBLIC__/shop/set.css">
<script>
    var __businessHours = {$shopInfo.businessHours|json_encode};
</script>
<div class="container-fluid">
    <div class="row">
        <include file="./Application/Admin/View/Shop/editShopMenuWidget.html"/>
        <div class="col-md-12">
        <form role="form" id="frm_edit_shop" action="/Admin/Shop/editShop" method="post" class="form-horizontal">
        <input type="hidden" name="shopCode" value="{$shopInfo.shopCode}" id="shopCode" />
        <input type="hidden" value="shop" id="shopType" />
        <div class="container-fluid">
<!--        <div class="row">-->
<!--            <div class="col-md-12"><h4><strong>所属品牌</strong></h4></div>-->
<!--            <div class="col-md-12">-->
<!--                <div class="form-group">-->
<!--                    <label for="brand-id" class="col-md-1">品牌</label>-->
<!--                    <div class="col-md-8">-->
<!--                        <select class="form-control js-brand-id-slt" name="brandId[]" id="brand-id" multiple>-->
<!--                            <option value="">请选择品牌</option>-->
<!--                            <foreach name="brandList" item="item">-->
<!--                                <option value="{$item.brandId}" <foreach name="shopInfo.brandList" item="shopBrand"><eq name="shopBrand.brandId" value="$item.brandId">selected</eq></foreach>>{$item.brandName}</option>-->
<!--                            </foreach>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    <div class="col-md-1"><a href="/Admin/Brand/editBrand" class="btn btn-sm btn-default">添加品牌</a></div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-12"><hr/></div>-->
<!--        </div>-->
        <div class="row">
            <div class="col-md-12"><h4><strong>基本信息</strong></h4></div>
            <div class="col-sm-6 col-md-4">
                <div class="form-group">
                    <label for="parent-code" class="col-md-4">总店</label>
                    <div class="col-md-8">
                        <select class="form-control js-parent-single" name="parentCode" id="parent-code">
                            <option value="">请选择总店</option>
                            <foreach name="parentList" item="item">
                                <option value="{$item.shopCode}"<eq name="shopInfo.parentCode" value="$item.shopCode">selected="selected"</eq>>{$item.shopName}</option>
                            </foreach>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <input type="hidden" value="" id="search_info_country" />
                    <label for="country" class="col-md-4"><span class='required-ele'>*</span>国家</label>
                    <div class="col-md-8">
                        <select class="form-control" name="country" id="country">
                            <option value="中国" <eq name="shopInfo.country" value="中国">selected="selected"</eq>>中国</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <input type="hidden" value="" id="search_info_city" />
                    <input type="hidden" value="{$shopInfo.province}" id="search-province"/>
                    <label for="province" class="col-md-4"><span class='required-ele'>*</span>省份/直辖市/特别行政区</label>
                    <div class="col-md-8">
                        <select class="form-control"择 name="province" id='province'>
                            <option value="">请选省份</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <input type="hidden" value="{$shopInfo.city}" id="search-city"/>
                    <label for="city" class="col-md-4"><span class='required-ele'>*</span>城市/区域</label>
                    <div class="col-md-8">
                        <select class="form-control" name='city' id='city'>
                            <option value="">请选择城市</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <input type="hidden" value="{$shopInfo.district}" id="search-district"/>
                    <label for="district" class="col-md-4">地区</label>
                    <div class="col-md-8">
                        <select class="form-control" name='district' id='district'>
                            <option value="">请选择地区</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="street" class="col-md-4">街道地址</label>
                    <div class="col-md-8">
                        <textarea class="form-control" name="street" id="street" rows="5" placeholder="街道地址" style="resize: none">{$shopInfo.street}</textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label for="shop-name" class="col-md-4"><span class='required-ele'>*</span>商户名称</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="shopName" value="{$shopInfo.shopName}" placeholder="商户名称" id="shop-name"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="type" class="col-md-4"><span class='required-ele'>*</span>商户类型</label>
                    <div class="col-md-8">
                        <select class="form-control slt-shop-type" name="type[]" id="type" multiple="multiple">
                            <foreach name="shopTypeList" item="shopType">
                                <option value="{$shopType.shopTypeId}" <in name="shopType.typeValue" value="$strShopType">selected="selected"</in>>{$shopType.typeZh}</option>
                            </foreach>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="shop-status" class="col-md-4"><span class='required-ele'>*</span>商户状态</label>
                    <div class="col-md-8">
                        <select class="form-control" name="shopStatus" id="shop-status">
                            <option value="1" <eq name="shopInfo.shopStatus" value="1">selected="selected"</eq>>未入驻</option>
                            <option value="2" <eq name="shopInfo.shopStatus" value="2">selected="selected"</eq>>已入驻</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label  for="shop-status" class="col-md-4"><span class='required-ele'>*</span>所属平台</label>
                    <div class="col-sm-8">
                        <select name="bank_id" id="" class="form-control">
                            <foreach name="bankList" item="item21">
                                <option value="{$item21.id}" <eq name="item21.id" value="$shopInfo.bank_id">selected="selected"</eq>>{$item21.name}</option>
                            </foreach>
                        </select>
                    </div>
                </div>

            </div>
            <div class="col-sm-6 col-md-4">
                <div class="form-group">
                    <label for="license-nbr" class="col-md-4"><span class='required-ele'>*</span>营业执照编号</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="licenseNbr" value="{$shopInfo.licenseNbr}" placeholder="营业执照编号" id="license-nbr"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="license-expire-time" class="col-md-4"><span class='required-ele'>*</span>营业执照到期日</label>
                    <div class="col-md-8">
                        <input type="text" class="form_datetime form-control ipt-date-time-picker" name="licenseExpireTime" value="{$shopInfo.licenseExpireTime}" readonly id="license-expire-time" placeholder="点击选择日期"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="tel" class="col-md-4"><span class='required-ele'>*</span>商户固定电话</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="tel" value="{$shopInfo.tel}" placeholder="商户固定电话" id="tel"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="mobile-nbr" class="col-md-4"><span class='required-ele'>*</span>商户预留电话</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="mobileNbr" value="{$shopInfo.mobileNbr}" placeholder="商户预留电话" id="mobile-nbr"/>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-4">
                        <span class='required-ele'>*</span>营业时间
                    </label>
                    <div class="col-md-8 input-group add-padding">
                        <button type="button" class="btn btn-success btn-xs plus" data-bind="click:addHour"><div class="glyphicon glyphicon-plus"></div></button>
                    </div>
                </div>
                <!-- ko foreach: hour -->
                <div class="form-group">
                    <label class="col-md-4">
                        <button type="button" class="btn btn-danger btn-xs minus" data-bind="click:$parent.delHour, style: { display: $index() == 0 ? 'none' : 'inline' }"><div class="glyphicon glyphicon-minus"></div></button>
                    </label>
                    <div class="col-md-8 input-group add-padding">
                        <input type="text" class="business-start-time form-control ipt-date-time-picker" name="shopOpeningTime[]" data-bind="value:open" readonly placeholder="开始时间"/>
                        <span class="input-group-addon frm-span">至</span>
                        <input type="text" class="business-end-time form-control ipt-date-time-picker" name="shopClosedTime[]" data-bind="value:close" readonly placeholder="结束时间"/>
                    </div>
                </div>
                <!-- /ko -->
                <div class="form-group">
                    <label for="short-des" class="col-md-4">商户简介</label>
                    <div class="col-md-8">
                        <textarea class="form-control" name="shortDes" rows="10" id="short-des" placeholder="商户简介" style="resize: none">{$shopInfo.shortDes}</textarea>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-4">
                <div class="form-group">
                    <label for="longitude" class="col-md-4">商店经度</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="longitude" value="{$shopInfo.longitude}" id="longitude" placeholder="商店经度"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="latitude" class="col-md-4">商店纬度</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="latitude" value="{$shopInfo.latitude}" id="latitude" placeholder="商店纬度"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="sub-type" class="col-md-4">子类型</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" name="subType" value="{$shopInfo.subType}" disabled="disabled" id="sub-type">
                    </div>
                </div>
                <div class="form-group">
                    <label for="is-catering" class="col-md-4">商户行业</label>
                    <div class="col-md-8">
                        <select name="isCatering" id="is-catering" class="form-control">
                            <option value="0" <eq name="shopInfo.isCatering" value="0">selected="selected"</eq>>未知</option>
                            <option value="1" <eq name="shopInfo.isCatering" value="1">selected="selected"</eq>>餐饮</option>
                            <option value="2" <eq name="shopInfo.isCatering" value="2">selected="selected"</eq>>教育</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-4">是否为公司</label>
                    <div class="col-md-8">
                        <label class="radio-inline">
                            <input type="radio" name="isCompany" value="1" <eq name="shopInfo.isCompany" value="1">checked="checked"</eq>> 是
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="isCompany" value="0" <eq name="shopInfo.isCompany" value="0">checked="checked"</eq>> 否
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-4"><span class='required-ele'>*</span>是否暂停营业</label>
                    <div class="col-md-8">
                        <label class="radio-inline">
                            <input type="radio" name="isSuspended" value="1" <eq name="shopInfo.isSuspended" value="1">checked="checked"</eq>> 是
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="isSuspended" value="0" <eq name="shopInfo.isSuspended" value="0">checked="checked"</eq>> 否
                        </label>
                    </div>
                </div>
                <!--<div class="form-group">-->
                    <!--<label for="industry-of-small-class" class="col-md-4">行业小类</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<input type="text" class="form-control" name="industryOfSmallClass" value="{$shopInfo.industryOfSmallClass}" placeholder="行业小类" id="industry-of-small-class"/>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                    <!--<label for="retrieve-tag" class="col-md-4">商户检索标签</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<input type="text" class="form-control" name="retrieveTag" value="{$shopInfo.retrieveTag}" placeholder="商户检索标签" id="retrieve-tag"/>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                    <!--<label for="special-info" class="col-md-4">商户特色信息</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<input type="text" class="form-control" name="specialInfo" value="{$shopInfo.specialInfo}" placeholder="商户特色信息" id="special-info"/>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                    <!--<label for="bank-service-support" class="col-md-4">支持的银行服务</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<input type="text" class="form-control" name="bankServiceSupport" value="{$shopInfo.bankServiceSupport}" placeholder="商户支持的银行服务" id="bank-service-support"/>-->
                    <!--</div>-->
                <!--</div>-->
            </div>
            <div class="col-md-12"><hr/></div>
        </div>
        <!--<div class="row">-->
            <!--<div class="col-md-12"><h4><strong>所属商圈</strong></h4></div>-->
            <!--<div class="form-group add-linked-city-wrap">-->
                <!--<label class="col-sm-2 control-label">所属商圈</label>-->
                <!--<div class="col-sm-9">-->
                    <!--<select class="js-data-add-city-ajax" multiple="multiple" name="linkedShopTrading[]" style="width: 100%">-->
                        <!--<foreach name="tradingAreaList" item="item">-->
                            <!--<option value="{$item.id}" <foreach name="linkedTradingArea" item="linkedShopTrading"><eq name="linkedShopTrading.subModuleId" value="$item.id">selected="selected"</eq></foreach>>{$item.title} - {$item.name}</option>-->
                        <!--</foreach>-->
                    <!--</select>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-12"><hr/></div>-->
        <!--</div>-->
        <div class="row">
            <div class="col-md-12"><h4><strong>商户大店长信息</strong></h4></div>
            <empty name="shopInfo.shopCode">
                <div class="col-sm-6 col-md-6">
                    <div class="form-group">
                        <label for="big-mng-real-name" class="col-md-4"><span class='required-ele'>*</span>大店长姓名</label>
                        <div class="col-md-8">
                            <input type="text" class="form-control" name="bigMngRealName" value="" placeholder="大店长姓名" id="big-mng-real-name"/>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-6">
                    <div class="form-group">
                        <label for="big-mng-mobile-nbr" class="col-md-4"><span class='required-ele'>*</span>大店长手机号</label>
                        <div class="col-md-8">
                            <input type="text" class="form-control" name="bigMngMobileNbr" value="" placeholder="大店长手机号" id="big-mng-mobile-nbr"/>
                        </div>
                    </div>
                </div>
                <else/>
                <input type="hidden" name="bigMngCode" id="big-mng-code" value="{$bigMngInfo.staffCode}" />
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="col-md-4">大店长姓名</label>
                        <div class="col-md-8 bigMngRealName">{$bigMngInfo.realName}</div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-6">
                    <div class="form-group">
                        <label class="col-md-4">大店长手机号</label>
                        <div class="col-md-8 bigMngMobileNbr">{$bigMngInfo.mobileNbr}</div>
                    </div>
                </div>
            </empty>
            <div class="col-md-12"><hr/></div>
        </div>
        <!--<div class="row">-->
            <!--<div class="col-md-2">-->
                <!--<h4><strong>商户的工行相关信息</strong></h4>-->
            <!--</div>-->
            <!--<eq name="cmsba" value="true">-->
                <!--<div class="col-md-8">-->
                    <!--<button type="button" class="btn btn-success btn-sm">修改商户账户</button>-->
                <!--</div>-->
            <!--</eq>-->
            <!--<div class="col-md-12"></div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="online-payment-discount" class="col-md-4"><span class='required-ele'>*</span>工行卡折扣</label>-->
                    <!--<div class="col-md-8 input-group add-padding">-->
                        <!--<input type="text" class="form-control" name="onlinePaymentDiscount" value="{$shopInfo.onlinePaymentDiscount|default=10}" placeholder="工行卡折扣" id="online-payment-discount"/>-->
                        <!--<span class="input-group-addon frm-span">折</span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="online-payment-discount-upper-limit" class="col-md-4"><span class='required-ele'>*</span>工行卡折扣上限金额（0表示无上限）</label>-->
                    <!--<div class="col-md-8 input-group add-padding">-->
                        <!--<input type="text" class="form-control" name="onlinePaymentDiscountUpperLimit" value="{$shopInfo.onlinePaymentDiscountUpperLimit}" placeholder="工行卡折扣上限金额" id="online-payment-discount-upper-limit"/>-->
                        <!--<span class="input-group-addon frm-span">元</span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-2"></div>-->
            <!--<div class="col-md-10" style="color: #ff211c">提醒：设置了<strong>工行商户名称</strong>和<strong>工行入账商户号</strong>后，资金将不会进入内部账号</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="icbc-shop-name" class="col-md-4">工行商户名称</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<input type="text" class="form-control" name="icbcShopName" value="{$shopInfo.icbcShopName}" placeholder="工行商户名称" id="icbc-shop-name"/>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="icbc-shop-code" class="col-md-4">工行入账商户号</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<input type="text" class="form-control" name="icbcShopCode" value="{$shopInfo.icbcShopCode}" placeholder="工行商户代码" id="icbc-shop-code"/>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="add-card-no" class="col-md-4"><span class='required-ele'>*</span>商户入账账户</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<if condition="$cmsba eq false">-->
                            <!--<empty name="shopInfo.addCardNo">-->
                                <!--暂无-->
                                <!--<else/>-->
                                <!--{$shopInfo.addCardNo|substr=0,6}****{$shopInfo.addCardNo|substr=-4}-->
                            <!--</empty>-->
                            <!--<else/>-->
                            <!--<input type="text" class="form-control" name="addCardNo" value="{$shopInfo.addCardNo}" placeholder="商户入账账号" id="add-card-no"/>-->
                        <!--</if>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="add-card-user-name" class="col-md-4"><span class='required-ele'>*</span>账户户名</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<if condition="$cmsba eq false">-->
                            <!--<empty name="shopInfo.addCardNo">-->
                                <!--暂无-->
                                <!--<else/>-->
                                <!--{$shopInfo.addCardUserName|msubstr=0,1,'utf-8',false}**-->
                            <!--</empty>-->
                            <!--<else/>-->
                            <!--<input type="text" class="form-control" name="addCardUserName" value="{$shopInfo.addCardUserName}" placeholder="账户户名" id="add-card-user-name"/>-->
                        <!--</if>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<if condition="$cmsba eq true">-->
                <!--<div class="col-md-6">-->
                    <!--<div class="form-group">-->
                        <!--<label for="add-card-no-confirm" class="col-md-4"><span class='required-ele'>*</span>确认商户入账账户</label>-->
                        <!--<div class="col-md-8">-->
                            <!--<input type="text" class="form-control" name="addCardNoConfirm" value="{$shopInfo.addCardNo}" placeholder="确认商户入账账号" id="add-card-no-confirm"/>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="col-md-6">-->
                    <!--<div class="form-group">-->
                        <!--<label for="add-card-user-name-confirm" class="col-md-4"><span class='required-ele'>*</span>确认账户户名</label>-->
                        <!--<div class="col-md-8">-->
                            <!--<input type="text" class="form-control" name="addCardUserNameConfirm" value="{$shopInfo.addCardUserName}" placeholder="确认账户户名" id="add-card-user-name-confirm"/>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</if>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="icbc-city-nbr" class="col-md-4"><span class='required-ele'>*</span>工行商户地区号</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<empty name="shopInfo.icbcCityNbr">-->
                            <!--<select name="icbcCityNbr" id="icbc-city-nbr" multiple class="form-control">-->
                                <!--<option value="">请选择地区号</option>-->
                                <!--<foreach name="areaNbrList" item="item">-->
                                    <!--<option value="{$item.areaNbr}" <notempty name="shopInfo.icbcCityNbr"><eq name="shopInfo.icbcCityNbr" value="$item.areaNbr">selected="selected"</eq></notempty>>{$item.areaNbr|default="暂无"} {$item.name}</option>-->
                                <!--</foreach>-->
                            <!--</select>-->
                            <!--<else/>-->
                            <!--{$shopInfo.icbcCityNbr}-->
                        <!--</empty>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="icbc-city-nbr" class="col-md-4">内部户商户号</label>-->
                    <!--<div class="col-md-8">-->
                        <!--<empty name="shopInfo.hqIcbcShopNbr">-->
                            <!--暂无-->
                            <!--<else/>-->
                            <!--{$shopInfo.hqIcbcShopNbr|substr=0,4}******-->
                        <!--</empty>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-12"><hr/></div>-->
        <!--</div>-->
        <!--<div class="row">-->
            <!--<div class="col-md-12"><h4><strong>商户服务</strong></h4></div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否受理银行卡</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isAcceptBankCard" value="1" <eq name="shopInfo.isAcceptBankCard" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isAcceptBankCard" value="0" <eq name="shopInfo.isAcceptBankCard" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否支持无线上网</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="hasWifi" value="1" <eq name="shopInfo.hasWifi" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="hasWifi" value="0" <eq name="shopInfo.hasWifi" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否免费停车</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isFreeParking" value="1" <eq name="shopInfo.isFreeParking" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isFreeParking" value="0" <eq name="shopInfo.isFreeParking" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否给新利开发票</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isInvoiceToXinli" value="1" <eq name="shopInfo.isInvoiceToXinli" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isInvoiceToXinli" value="0" <eq name="shopInfo.isInvoiceToXinli" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否允许携带宠物</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isAllowPet" value="1" <eq name="shopInfo.isAllowPet" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isAllowPet" value="0" <eq name="shopInfo.isAllowPet" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-md-12"><hr/></div>-->
        <!--</div>-->
        <!--<div class="row div-catering-set-wrap">-->
            <!--<div class="col-md-12"><h4><strong>餐饮类商家设置</strong></h4></div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否外卖</div>-->
                <!--<label class="radio-inline aaaa">-->
                    <!--<input type="radio" name="isOuttake" value="1" <eq name="shopInfo.isOuttake" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline aaaa">-->
                    <!--<input type="radio" name="isOuttake" value="0" <eq name="shopInfo.isOuttake" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否开启外卖</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isOpenTakeout" value="1" <eq name="shopInfo.isOpenTakeout" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isOpenTakeout" value="0" <eq name="shopInfo.isOpenTakeout" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">是否开启堂食</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isOpenEat" value="1" <eq name="shopInfo.isOpenEat" value="1">checked="checked"</eq>> 是-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="isOpenEat" value="0" <eq name="shopInfo.isOpenEat" value="0">checked="checked"</eq>> 否-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">堂食支付类型</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="eatPayType" value="1" <eq name="shopInfo.eatPayType" value="1">checked="checked"</eq>> 餐前支付-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="eatPayType" value="2" <eq name="shopInfo.eatPayType" value="2">checked="checked"</eq>> 餐后支付-->
                <!--</label>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-4 col-md-2">-->
                <!--<div class="radio-title-shop">桌号管理</div>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="tableNbrSwitch" value="1" <eq name="shopInfo.tableNbrSwitch" value="1">checked="checked"</eq>> 开启-->
                <!--</label>-->
                <!--<label class="radio-inline">-->
                    <!--<input type="radio" name="tableNbrSwitch" value="0" <eq name="shopInfo.tableNbrSwitch" value="0">checked="checked"</eq>> 关闭-->
                <!--</label>-->
            <!--</div>-->
        <!--</div>-->
        <!--<div class="row div-catering-set-wrap">-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="takeout-require-price" class="col-md-4">起送价</label>-->
                    <!--<div class="col-md-8 input-group add-padding">-->
                        <!--<input type="text" class="form-control" name="takeoutRequirePrice" value="{$shopInfo.takeoutRequirePrice}" id="takeout-require-price"/>-->
                        <!--<span class="input-group-addon frm-span">元</span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="delivery-fee" class="col-md-4">配送费</label>-->
                    <!--<div class="col-md-8 input-group add-padding">-->
                        <!--<input type="text" class="form-control" name="deliveryFee" value="{$shopInfo.deliveryFee}" id="delivery-fee"/>-->
                        <!--<span class="input-group-addon frm-span">元</span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="delivery-distance" class="col-md-4">最远配送距离</label>-->
                    <!--<div class="col-md-8 input-group add-padding">-->
                        <!--<input type="text" class="form-control" name="deliveryDistance" value="{$shopInfo.deliveryDistance}" id="delivery-distance"/>-->
                        <!--<span class="input-group-addon frm-span">米</span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                    <!--<label for="delivery-start-time" class="col-md-4">外卖配送时间</label>-->
                    <!--<div class="col-md-8 input-group add-padding">-->
                        <!--<input type="text" class="form_time form-control" name="deliveryStartTime" value="{$shopInfo.deliveryStartTime}" readonly id="delivery-start-time" placeholder="开始时间"/>-->
                        <!--<span class="input-group-addon frm-span">至</span>-->
                        <!--<input type="text" class="form_time form-control" name="deliveryEndTime" value="{$shopInfo.deliveryEndTime}" readonly placeholder="结束时间"/>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-12"><hr/></div>-->
        <!--</div>-->
        <div class="row" style="margin: 10px 0px;border: 1px solid #000;border-radius: 4px;">
            <div class="col-xs-3">
                <input type="hidden" value="{$shopInfo.logoUrl}" name="logoUrl" id="logoUrl">
                <label style="margin-top: 10px;">商店头像: </label>
                <div class="row-fluid employee-item-img">
                    <div class="employee-item-imgdiv">
                        <img name="avatar" src="{$shopInfo.logoUrl|default='__PUBLIC__/img/upload.png'}" class="avatar img-responsive img-rounded">
                    </div>
                    <div class="J_avatar"></div>
                </div>
            </div>
            <if condition="$user.mobileNbr EQ '18767174523'">
                <div class="col-xs-3">
                    <input type="hidden" value="{$shopInfo.licenseUrl}" name="licenseUrl" id="licenseUrl">
                    <label style="margin-top: 10px;">商店营业执照: </label>
                    <div class="row-fluid employee-item-img">
                        <div class="employee-item-imgdiv">
                            <img name="avatar" src="{$shopInfo.licenseUrl|default='__PUBLIC__/img/upload.png'}" class="license img-responsive img-rounded">
                        </div>
                        <div class="J_license"></div>
                    </div>
                </div>
                <div class="col-xs-3">
                    <input type="hidden" value="{$shopInfo.bankCardUrl}" name="bankCardUrl" id="bankCardUrl">
                    <label style="margin-top: 10px;">银行卡: </label>
                    <div class="row-fluid employee-item-img">
                        <div class="employee-item-imgdiv">
                            <img name="avatar" src="{$shopInfo.bankCardUrl|default='__PUBLIC__/img/upload.png'}" class="bankCard img-responsive img-rounded">
                        </div>
                        <div class="J_bankcard"></div>
                    </div>
                </div>
                <div class="col-xs-3">
                    <input type="hidden" value="{$shopInfo.protocolUrl}" name="protocolUrl" id="protocolUrl">
                    <label style="margin-top: 10px;">惠圈协议: </label>
                    <div class="row-fluid employee-item-img">
                        <div class="employee-item-imgdiv">
                            <img name="avatar" src="{$shopInfo.protocolUrl|default='__PUBLIC__/img/upload.png'}" class="protocol img-responsive img-rounded">
                        </div>
                        <div class="J_protocol"></div>
                    </div>
                </div>
                <div class="col-md-12" style="font-size: 20px;margin-bottom: 10px">
                    开户人身份证
                    <a href="#" class="btn btn-danger btn-xs ready-to-del-idcard">删除</a>
                    <a href="#" class="btn btn-warning btn-xs cancel-del-idcard">取消删除</a>
                </div>
                <div class="col-xs-12">
                    <div id="shopIDcard">
                        <foreach name="shopInfo.IDcardUrl" item="vo" >
                            <div class="col-md-3 shop-idcard-wrap" id="shop-idcard-wrap-{$key}">
                                <div class="del-shop-idcard"></div>
                                <img src="{$vo|default='__PUBLIC__/img/upload.png'}" class="img-responsive img-rounded decoration-img">
                                <input type="hidden" class="form-control" name="IDcardUrl[]" value="{$vo}" />
                            </div>
                        </foreach>
                    </div>
                    <div class="row-fluid employee-item-img">
                        <div class="employee-item-imgdiv">
                            <img name="id_card" src="__PUBLIC__/img/upload.png" class="J_id_card img-responsive img-rounded">
                        </div>
                        <div class="J_idcard"></div>
                    </div>
                </div>
            </if>
        </div>
        <div class="row" style="margin: 10px 0px;border: 1px solid #000;border-radius: 4px;">
            <div class="col-xs-12 shop-decoration-wrap">
                <div class="col-md-12" style="font-size: 20px;margin-bottom: 10px">
                    商家环境图片（可一次选择多张上传）
                    <a href="#" class="btn btn-danger btn-xs ready-to-del-decoration">删除</a>
                    <a href="#" class="btn btn-warning btn-xs cancel-del-decoration">取消删除</a>
                </div>
                <div id="shop-decoration-wrap">
                    <foreach name="shopInfo.decoration" item="vo" >
                        <div class="col-md-3 decoration-wrap" id="decoration-wrap-{$vo.decorationCode}">
                            <div class="del-shop-decoration"></div>
                            <img src="{$vo.imgUrl|default='__PUBLIC__/img/upload.png'}" class="img-responsive img-rounded decoration-img">
                            <input type="hidden" class="form-control" name="decorationCode[]" value="{$vo.decorationCode}" />
                            <input type="hidden" class="form-control" name="imgUrl[]" value="{$vo.imgUrl}" />
                            <div class="form-group">
                                <label>标题</label>
                                <input type="text" class="form-control" name="title[]" value="{$vo.title}" placeholder="标题"/>
                            </div>
                            <div class="form-group">
                                <label>描述</label>
                                <textarea class="form-control decoration-short-des" name="decoShortDes[]" rows="4" placeholder="描述">{$vo.shortDes}</textarea>
                            </div>
                        </div>
                    </foreach>
                </div>
                <div class="row-fluid employee-item-img">
                    <div class="employee-item-imgdiv">
                        <img name="business_card" src="__PUBLIC__/img/upload.png" class="J_business_card img-responsive img-rounded">
                    </div>
                    <div class="shop-decoration-picker"></div>
                </div>
            </div>
            <div class="col-xs-12" style="margin: 10px 0;">
                <label style="margin-top: 10px;">产品相册:
                    <button type="button" class="btn btn-success btn-xs" style="margin-left: 50px;" id="album_add">新增</button>
                    <button type="button" class="btn btn-danger btn-xs" style="margin-left: 20px;" id="album_del" data_type="1">删除</button>
                </label>
                <div class="col-xs-12" id="sub_album" style="margin-top: 20px;">
                    <foreach name="shopInfo.product" item="pro">
                        <div class="col-xs-2" align="center" id="album_{$pro.code}" style="position: relative;">
                            <a href="/Admin/Shop/listAlbumPhoto/code/{$pro.code}"><img src="__PUBLIC__/img/icon/album.png" class="img-responsive img-rounded"><p>{$pro.name}</p></a>
                            <button type="button" class="btn btn-xs btn-danger" action="del_album" code="{$pro.code}" style="display: none;">移除</button>
                        </div>
                    </foreach>
                </div>
                <empty name="shopInfo.shopCode">
                    <!--<div class="col-md-2">-->
                    <!--<button type="button" class="btn btn-info btn-block add-shop-decoration">添加商家背景图片</button>-->
                    <!--</div>-->
                </empty>
            </div>
        </div>
        <!--<div class="row">-->
            <!--<div class="col-md-12"><h4><strong>邀请的奖励系数设置</strong></h4></div>-->
            <!--<div class="col-md-12">-->
                <!--<div class="form-group">-->
                    <!--<label for="reg-reward-coefficient" class="col-md-2">-->
                        <!--<span class='required-ele'>*</span>邀请注册的奖励系数-->
                    <!--</label>-->
                    <!--<div class="col-md-2">-->
                        <!--<input type="text" class="form-control regRewardCoefficient" name="regRewardCoefficient" value="{$shopInfo.regRewardCoefficient}" placeholder="邀请注册的奖励系数" id="reg-reward-coefficient"/>-->
                    <!--</div>-->
                    <!--<label for="r-a-c-reward-ccoefficient" class="col-md-2">-->
                        <!--<span class='required-ele'>*</span>邀请注册并消费的奖励系数-->
                    <!--</label>-->
                    <!--<div class="col-md-2">-->
                        <!--<input type="text" class="form-control rACRewardCcoefficient" name="rACRewardCcoefficient" value="{$shopInfo.rACRewardCcoefficient}"  placeholder="邀请注册并消费的奖励系数" id="r-a-c-reward-ccoefficient"/>-->
                    <!--</div>-->
                    <!--<div class="col-md-1">-->
                        <!--<button class="btn btn-success btn-sm cal-reward-point" type="button">计算奖励值</button>-->
                    <!--</div>-->
                    <!--<div class="col-md-2">-->
                        <!--<div class="col-xs-12">注册人数：<span class="regNbr">{$shopInfo.regNbr}</span></div>-->
                        <!--<div class="col-xs-12">注册并消费人数：<span class="regACNbr">{$shopInfo.regACNbr}</span></div>-->
                        <!--<div class="col-xs-12">奖励值：<span class="rewardPoint">{$shopInfo.rewardPoint}</span></div>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="col-md-12"><hr/></div>-->
        <!--</div>-->
        <div class="row" style="margin-bottom: 20px;">
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary btn-block" id="submit">保存</button>
            </div>
        </div>
        </div>
        </form>
        </div>
    </div>
</div>
<!--add_album_Modal-->
<div class="modal bs-example-modal-sm form-po-processing" id="add_album_Modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" style="top:20%;left:12.5%;width:75%;">
    <div class="modal-dialog" style="left: 0;">
        <div class="modal-content">
            <div class="modal-header">
                <a href="javascript:;" class="close" id="cl">&times;</a>
                <h4 class="modal-title">新建产品目录</h4>
            </div>
            <div class="modal-body" id="vendor">
                <div class="alert alert-dismissible" role="alert" id="alert_code" style="display: none">
                    <button type="button" class="close" data-dismiss="alert">&times;</span><span class="sr-only">Close</span></button>
                    <strong id="message_code"></strong>
                </div>
                <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label class="col-md-2 col-md-offset-2">目录名：</label>
                        <div class="col-md-7">
                            <input class="form-control input-sm" style="width: 200px;" name="album_name" id="album_name" />
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="modal_save">保存</button>
                <button type="button" class="btn btn-danger" id="modal_close">取消</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!--<script src="http://api.map.baidu.com/api?v=1.5&ak=mG5hg7F9fN7u8gZWTLGNlBRg" type="text/javascript"></script>-->
<script src="https://api.map.baidu.com/api?v=1.5&ak=mG5hg7F9fN7u8gZWTLGNlBRg" type="text/javascript"></script>
<div id="container"></div>
<script type="text/javascript">
// 返回提示页面显示的信息
;(function(){
    window.onbeforeunload = function() {
//        return "是否离开当前页面";
    };
})();


//工商商户地区号
// $("#icbc-city-nbr").select2({
//     placeholder:"必须选择此项",
//     allowClear: true,		//选择后重置
//     // minimumInputLength: 1,//必须输入1个字符才能搜索
//     maximumSelectionLength : 1,
//     // closeOnSelect:false,
// });

// 删除商家环境图片相关
;(function(){
    // 预备删除商家环境图片
    $('.ready-to-del-decoration').on('click', function(){
        var html = '<a class="btn btn-danger btn-xs del-shop-decoration-btn">删除</a>';
        $('.del-shop-decoration').html(html).show();
        $('.del-shop-decoration-btn').on('click', function(){
            var btn = $(this);
            btn.parent().parent().remove();
            return false;
        });
        $(this).hide();
        $('.cancel-del-decoration').show();
        return false;
    });
    // 取消删除商家环境图片
    $('.cancel-del-decoration').on('click', function(){
        $('.del-shop-decoration').empty().hide();
        $(this).hide();
        $('.ready-to-del-decoration').show();
        return false;
    });
})();

// 删除商户开户人身份证图片
;(function(){
    // 预备删除商户开户人身份证图片
    $('.ready-to-del-idcard').on('click', function(){
        var html = '<a class="btn btn-danger btn-xs del-shop-idcard-btn">删除</a>';
        $('.del-shop-idcard').html(html).show();
        $('.del-shop-idcard-btn').on('click', function(){
            var btn = $(this);
            btn.parent().parent().remove();
            return false;
        });
        $(this).hide();
        $('.cancel-del-idcard').show();
        return false;
    });
    // 取消删除商户开户人身份证图片
    $('.cancel-del-idcard').on('click', function(){
        $('.del-shop-idcard').empty().hide();
        $(this).hide();
        $('.ready-to-del-idcard').show();
        return false;
    });
})();

$(function() {
    $(".js-data-add-city-ajax").select2({
        placeholder: "请选商圈"
    });

    del_id_card();
    del_decoration();
    del_album();

    $('.form_time').datetimepicker({
        format: 'hh:ii',
        autoclose: true,
        startView: 'day',
        minuteStep: 1
    });
    $('.form_datetime').datetimepicker({
        format: 'yyyy-mm-dd',
        autoclose: true,
        minView: 'month',
        todayBtn: '1'
    });

    $('#album_add').click(function(){
        $('#add_album_Modal').modal('show');
        $("#album_name").val('');
    });

    $('#modal_close').click(function(){
        $('#add_album_Modal').modal('hide');
    });

    $('#cl').click(function(){
        $('#add_album_Modal').modal('hide');
    });

    $('#modal_save').click(function(){
        var name = $("#album_name").val();
        var shopCode = $('#shopCode').val();
        var type = $('#album_del').attr('data_type');
        $(this).addClass('disabled');
        $(".alert").remove();
        $("#vendor").prepend('<div class="alert alert-dismissible" role="alert" id="alert_code" style="display:none"><button type="button" class="close" data-dismiss="alert" >&times;</span><span class="sr-only">Close</span></button><strong id="message_code"></strong> </div>');
        if(name == ''){
            $("#alert_code").show().addClass('alert-warning');
            $("#message_code").html('请输入目录名!');
            $("#modal_save").removeClass('disabled');
        }else{
            $.post(
                    '/Admin/Shop/addAlbum',
                    {
                        name:name,
                        shopCode:shopCode,
                        isAjax:true },
                    function(result) {
                        if (result.code == true) {
                            $("#add_album_Modal").modal('hide');
                            if(type == 1){
                                $('#sub_album').prepend('<div class="col-xs-2" align="center" id="album_'+result.subAlbumCode+'" style="position: relative;"><a href="/Admin/Shop/listAlbumPhoto/code/'+result.subAlbumCode+'"><img src="__PUBLIC__/img/icon/album.png" class="img-responsive img-rounded"><p>'+result.name+'</p></a><button type="button" class="btn btn-xs btn-danger" action="del_album" code="'+result.subAlbumCode+'" style="display: none;">移除</button></div>');
                            }else{
                                $('#sub_album').prepend('<div class="col-xs-2" align="center" id="album_'+result.subAlbumCode+'" style="position: relative;"><a href="/Admin/Shop/listAlbumPhoto/code/'+result.subAlbumCode+'"><img src="__PUBLIC__/img/icon/album.png" class="img-responsive img-rounded"><p>'+result.name+'</p></a><button type="button" class="btn btn-xs btn-danger" action="del_album" code="'+result.subAlbumCode+'">移除</button></div>');
                            }
                            del_album();
                        }else{
                            $("#alert_code").show().addClass('alert-warning');
                            $("#message_code").html(result.code);
                        }
                        $("#modal_save").removeClass('disabled');
                    }
            )
        }
    });

    // 初始化省份、城市、地区
    var defaultProvince = $('#search-province').val();
    var defaultCity = $('#search-city').val();
    var defaultDistrict = $('#search-district').val();
    sz.initDistrict(defaultProvince, defaultCity, defaultDistrict);

    //根据地址获取经纬度
    var map = new BMap.Map("container");
    var point = new BMap.Point(118.879005, 28.966899);
    map.centerAndZoom(point, 15);
    var localSearch = new BMap.LocalSearch(map);
    function searchByAddress(province, city, district) {

        console.log("province:"+province+"city:"+city+"district:"+district);

        if(! province) {
            province = $('#search-province').val();
        }
        if(! city) {
            city = $('#search-city').val();
        }
        if(! district) {
            district = $('#search-district').val();
        }
        var country = $('#country').val();
        var street = $("#street").val();
        var shopName = $('#shop-name').val();
        var keyword = province + city + district + street + shopName;
        localSearch.setSearchCompleteCallback(function (searchResult) {
            var poi = searchResult.getPoi(0);
            if(! poi) {
                sz.showErrMsg('没有找到相关地点，请仔细查看信息是否输入正确', 4);
                return false;
            }
            $("#longitude").val(poi.point.lng);
            $("#latitude").val(poi.point.lat);
        });
        localSearch.search(keyword);
    };

    $('#province, #city, #district, #street').change(function(){
        var province = $('#province').val();
        var city = $('#city').val();
        var district = $('#district').val();
        searchByAddress(province, city, district);
    });

    // 表单提交
    $('#frm_edit_shop').on('submit', function() {
        var subBtn = $('#submit');
        subBtn.attr('disabled', 'disabled');
        var frm = $(this);
        $.post(frm.attr('action'), frm.serialize(), function(resp) {
            console.log(resp);
            if (resp.status == sz.STATUS_SUCC) {
              //  $('.shopCode').val(resp.data.shopCode);
            //    location.href = '/Admin/Shop/editShop?shopCode=' + resp.data.shopCode;
               sz.showSuccMsg("保存成功", 3);
               //  alert("保存成功");
            } else {
                sz.showErrMsg(resp.msg, 3);
            }
        });
        subBtn.attr('disabled', false);
        return false;
    });
    // 计算奖励值
    function calRewardPoint() {
        var regRewardCoefficient = $('.regRewardCoefficient').val();
        var rACRewardCcoefficient = $('.rACRewardCcoefficient').val();
        var regNbr = $('.regNbr').text();
        var regACNbr = $('.regACNbr').text();
        var rewardPoint = regRewardCoefficient * regNbr + rACRewardCcoefficient * regACNbr;
        $('.rewardPoint').text(rewardPoint);
    }
    $('.cal-reward-point').on('click', calRewardPoint);
    // 初始化select2
    $('.js-parent-single').select2({
        placeholder: "请选总店",
        allowClear: true
    });
    // 选择品牌
    $('.js-brand-id-slt').select2({
        placeholder: "请选品牌"
    });
    // 选择商户类型
    $('.slt-shop-type').select2({
        placeholder: "请选择商户类型",
        allowClear: true
    })

    // 选择总店时，获取大店长信息
    var $parentSelect = $('.js-parent-single');
    $parentSelect.on("select2:select", function (e) {
        var shopCode = e.params.data.id;
        $.post('/Admin/Shop/getBigMngInfo', {'shopCode' : shopCode}, function(resp) {
            if(resp.data) {
                $('.bigMngRealName').text(resp.data.realName);
                $('.bigMngMobileNbr').text(resp.data.mobileNbr);
                $('#big-mng-code').val(resp.data.staffCode);
            } else {
                $('.bigMngRealName').text('');
                $('.bigMngMobileNbr').text('');
                $('#big-mng-code').val('');
            }
        });
    });

    $('.js-big-mng-single').select2({
        placeholder: "请选大店长",
        allowClear: true
    });
    $('.js-mng-single').select2({
        placeholder: "请选店长",
        allowClear: true
    });
//    $('.add-shop-decoration').on('click', function(){
//        sz.showErrMsg('请先保存商户基本信息', 3);
//    });

});
;(function(){
    // 营业时间初始化时间选择器
    function initBusinessTime() {
        // 营业开始时间的初始化时间选择器
        $('.business-start-time').datetimepicker({
            format: 'hh:ii',
            autoclose: true,
            startView: 'day',
            minuteStep: 1
        });
        // 营业结束时间的初始化时间选择器
        $('.business-end-time').datetimepicker({
            format: 'hh:ii',
            autoclose: true,
            startView: 'day',
            minuteStep: 1
        });
    };

    __businessHours = __businessHours || [];
    var viewMdl = function(data){
        var self = this;
        self.hour = ko.observableArray(data);
        self.addHour = function(){
            self.hour.push({
                open: '',
                close: ''
            });
            initBusinessTime();
        };
        self.delHour = function(){
            self.hour.remove(this);
        };
    };
    ko.applyBindings(new viewMdl(__businessHours));

    initBusinessTime();
})();
// 选择商户行业时的动作
;(function(){
    function checkShopIndustry() {
        var industry = $('#is-catering').val();
        var $cateringDiv = $('.div-catering-set-wrap');
        switch (industry) {
            case '1':
                $cateringDiv.show();
                break;
            case '2':
                $cateringDiv.hide();
                break;
            default :
                $cateringDiv.hide();
                break;
        }
    };
    $('#is-catering').on('change', checkShopIndustry);
    checkShopIndustry();
})();
</script>