webpackJsonp([12],{238:function(t,e,o){function r(t){o(368)}var n=o(0)(o(338),o(396),r,null,null);t.exports=n.exports},298:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["title"],methods:{goBack:function(){this.$router.go(-1)}}}},299:function(t,e){},300:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"header2"}},[o("header",{staticClass:"header"},[o("span",{staticClass:"header-item icon-back",on:{click:t.goBack}}),t._v(" "),o("span",{staticClass:"header-item"},[t._v(t._s(t.title))])])])},staticRenderFns:[]}},301:function(t,e,o){function r(t){o(299)}var n=o(0)(o(298),o(300),r,null,null);t.exports=n.exports},338:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(10),n=o.n(r),s=o(6),i=o(301),a=o.n(i);e.default={data:function(){return{count:1,isSucess:Boolean,currentOrderInfo:{countMyReceived:0,logoUrl:"",payPrice:0},batchCouponCode:this.$route.params.batchCouponCode,activeCode:this.$route.query.activeCode,discountPrice:0}},computed:n()({},o.i(s.b)(["global","CouponListInfo","isBLR","isLogin","userCode","appType"]),{totalPrice:function(){return""!==this.activeCode&&void 0!==this.activeCode?(this.count*this.discountPrice).toFixed(2):(this.count*this.currentOrderInfo.payPrice).toFixed(2)}}),watch:{count:function(){void 0===this.currentOrderInfo.countMyReceived&&(this.currentOrderInfo.countMyReceived=0),this.count=Math.round(this.count),(this.count>this.currentOrderInfo.nbrPerPerson-this.currentOrderInfo.countMyReceived||this.count>this.currentOrderInfo.nbrPerPerson)&&(this.count=this.currentOrderInfo.nbrPerPerson-this.currentOrderInfo.countMyReceived,this.$vux.toast.text("您已到达领取限额","middle"))}},methods:{goBack:function(){this.$router.go(-1)},add:function(){this.count++},minus:function(){this.count<2||this.count--},showIndexCouponDetails:function(){var t=this;this.axios({method:"post",url:this.global.hftcomShop,data:'{"id":19,"jsonrpc":"2.0","method":"getBachCouponInfo","params":{"batchCouponCode":"'+this.batchCouponCode+'"}}',contentType:"application/json",dataType:"json"}).then(function(e){t.currentOrderInfo=e.data.result.BatchCouponInfo,t.shopDecoration=e.data.result.ShopDecoration,t.currentOrderInfo.logoUrl=e.data.result.ShopDecoration.imgUrl,t.getUserCouponNbr(),t.getDiscountPrice()})},getDiscountPrice:function(){var t=this;this.axios({method:"post",url:"/Api/Activity",data:'{"id":19,"jsonrpc":"2.0","method":"getPrice","params":{"activityCode":"'+this.activeCode+'"}}',contentType:"application/json",dataType:"json"}).then(function(e){console.log(e),t.discountPrice=e.data.result})},getUserCouponNbr:function(){var t=this;this.axios({method:"post",url:this.global.hftcomShop,data:'{"id":19,"jsonrpc":"2.0","method":"getUserCouponNbr","params":{"userCode":"'+this.userCode+'","batchCouponCode":"'+this.batchCouponCode+'"}}',contentType:"application/json",dataType:"json"}).then(function(e){void 0===t.currentOrderInfo.countMyReceived&&(t.currentOrderInfo.countMyReceived=0),e.data.result===[]||void 0===e.data.result?e.data.result=[]:e.data.result.filter(function(e,o,r){"1"!==e.status&&"2"!==e.status||t.currentOrderInfo.countMyReceived++})})},submitOrder:function(){var t=this;if("0"!==this.currentOrderInfo.nbrPerPerson&&this.currentOrderInfo.nbrPerPerson-this.currentOrderInfo.countMyReceived<1)this.$vux.toast.text("您已经购买了"+this.currentOrderInfo.countMyReceived+"张，无法再次购买","middle");else{var e;e=""!==this.activeCode&&void 0!==this.activeCode?'{"id":19,"jsonrpc":"2.0","method":"addCouponOrder","params":{"userCode":"'+this.userCode+'","shopCode":"'+this.currentOrderInfo.shopCode+'","batchCouponCode":"'+this.currentOrderInfo.batchCouponCode+'","couponNbr":'+this.count+',"platBonus":0,"shopBonus":0,"activityCode":"'+this.activeCode+'"}}':'{"id":19,"jsonrpc":"2.0","method":"addCouponOrder","params":{"userCode":"'+this.userCode+'","shopCode":"'+this.currentOrderInfo.shopCode+'","batchCouponCode":"'+this.currentOrderInfo.batchCouponCode+'","couponNbr":'+this.count+',"platBonus":0,"shopBonus":0}}',this.axios({method:"post",url:this.global.hftcomClient,data:e}).then(function(e){switch(e.data.result.code){case 5e4:t.order=e.data.result,t.order.batchCouponCode=t.currentOrderInfo.batchCouponCode,t.order.payType="BUYCOUPON",console.log(e.data.result),t.$router.replace({path:"/gotopay",query:{order:t.order}});break;case"80238":t.$vux.toast.text("您已经达到购买上限","middle");break;case 9527:t.$vux.toast.text("请在个人中心完成手机号的绑定","bottom");break;case 9377:t.$vux.toast.text("未到优惠券领用时间","bottom");break;case"80220":t.$vux.toast.text("当前时间无法使用","middle");break;case"80221":t.$vux.toast.text("此优惠券已抢光，无法购买","middle");break;default:console.log(e.data.result.code)}})}}},created:function(){this.showIndexCouponDetails()},components:{header2:a.a}}},368:function(t,e){},396:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"submitorder"}},[o("header2",{attrs:{title:"提交订单"}}),t._v(" "),o("div",{staticClass:"order-item order-item-more"},[o("div",{staticClass:"img"},[o("img",{attrs:{src:t.global.hftcomImgSrc+t.currentOrderInfo.logoUrl,alt:""}})]),t._v(" "),o("div",{staticClass:"orderName"},[t._v(t._s(t.currentOrderInfo.couponName)+t._s(t.currentOrderInfo.function)+t._s(t.currentOrderInfo.remark))]),t._v(" "),o("div",{staticClass:"payPrice"},[o("span",{class:""!==t.activeCode&&void 0!==t.activeCode?"pricespan":""},[t._v("￥"+t._s(t.currentOrderInfo.payPrice)+"元")]),t._v(" "),""!==t.activeCode&&void 0!==t.activeCode&&1===this.appType?o("span",[t._v("￥"+t._s(t.discountPrice)+"元")]):t._e()])]),t._v(" "),o("div",{staticClass:"order-item"},[o("label",{attrs:{for:"count"}},[t._v("数量:")]),t._v(" "),o("div",{staticClass:"count-inp"},[o("span",{directives:[{name:"show",rawName:"v-show",value:"0"!==t.currentOrderInfo.nbrPerPerson,expression:"currentOrderInfo.nbrPerPerson!=='0'"}],staticClass:"nbrPerPerson"},[t._v("每个用户限领"+t._s(t.currentOrderInfo.nbrPerPerson)+"张")]),t._v(" "),o("div",{staticClass:"minus",class:{"minus-disabled":t.count<2},on:{click:t.minus}},[t._v("-")]),t._v(" "),o("div",{staticClass:"inp"},[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.count,expression:"count",modifiers:{number:!0}}],attrs:{id:"count",value:"1"},domProps:{value:t.count},on:{input:function(e){e.target.composing||(t.count=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),o("div",{staticClass:"add",on:{click:t.add}},[t._v("+")])])]),t._v(" "),o("div",{staticClass:"order-item"},[o("label",{attrs:{for:"price"}},[t._v("实付款:")]),t._v(" "),o("span",{staticClass:"totalPrice"},[t._v(t._s(t.totalPrice)+"元")])]),t._v(" "),o("div",{staticClass:"pay",on:{click:t.submitOrder}},[t._v("提交订单")])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=12.2749cd9402a34621e462.js.map