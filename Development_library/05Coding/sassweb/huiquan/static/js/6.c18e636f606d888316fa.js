webpackJsonp([6],{239:function(t,s,o){function e(t){o(351)}var i=o(0)(o(338),o(378),e,null,null);t.exports=i.exports},294:function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=o(13),i=o.n(e),a=o(116),n=(o.n(a),o(6));s.default={props:["imgSrcArr"],data:function(){return{swiperOption:{notNextTick:!0,autoplay:!0,effect:"effect",grabCursor:!1,setWrapperSize:!0,pagination:{el:".swiper-pagination",clickable:!0},prevButton:".swiper-button-prev",nextButton:".swiper-button-next",observeParents:!0},newImgSrcArr:["/Public/Uploads/20180528/5b0bb30255d5a.jpg","/Public/Uploads/20180528/5b0bb300010f7.jpg"]}},computed:i()({},o.i(n.b)(["global"])),watch:{imgSrcArr:function(){this.loadSwiper()}},methods:{loadSwiper:function(){void 0===this.imgSrcArr?this.imgSrcArr=[]:"String"===Object.prototype.toString.call(this.imgSrcArr).slice(8,-1)?this.newImgSrcArr.push(this.imgSrcArr):this.newImgSrcArr=this.imgSrcArr}},created:function(){this.loadSwiper()},components:{swiper:a.swiper,swiperSlide:a.swiperSlide}}},296:function(t,s){},299:function(t,s){t.exports={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{attrs:{id:"swiper"}},[o("swiper",{ref:"mySwiper",attrs:{options:t.swiperOption}},[t._l(t.newImgSrcArr,function(s){return o("swiper-slide",{key:s},[o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.global.hftcom+s,expression:"global.hftcom + img"}]})])}),t._v(" "),o("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],2),t._v(" "),t._l(t.newImgSrcArr,function(s){return o("p",[t._v("img")])})],2)},staticRenderFns:[]}},302:function(t,s,o){function e(t){o(296)}var i=o(0)(o(294),o(299),e,null,null);t.exports=i.exports},306:function(t,s,o){t.exports={default:o(307),__esModule:!0}},307:function(t,s,o){o(309),t.exports=o(4).Object.keys},308:function(t,s,o){var e=o(10),i=o(4),a=o(20);t.exports=function(t,s){var o=(i.Object||{})[t]||Object[t],n={};n[t]=s(o),e(e.S+e.F*a(function(){o(1)}),"Object",n)}},309:function(t,s,o){var e=o(46),i=o(36);o(308)("keys",function(){return function(t){return i(e(t))}})},338:function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=o(306),i=o.n(e),a=o(13),n=o.n(a),r=o(117),p=o.n(r),l=o(302),c=o.n(l),d=o(6);s.default={name:"shopdetail",data:function(){return{ok:!0,albumImg:"本店暂无图片",shopImgList:[],shopAllInfo:{couponList:{shopCoupon:[]},shopInfo:{shopName:""}},shopDecoList:[],shopAllInfoFlag:!1,isCollect:!1,viptype:1,isadding:"",showmask:!1}},computed:n()({},o.i(d.b)(["collectShopList","global","userCode","isLogin","zoneId"])),beforeCreate:function(){},methods:{goBack:function(){this.$router.go(-1)},getShopDetail:function(){var t=this;this.axios({method:"post",url:this.global.hftcomClient,data:'{"id":19,"jsonrpc":"2.0","method":"getShopInfo","params":{"shopCode":"'+this.$route.params.shopCode+'","userCode":"'+this.$store.state.userCode+'","longitude":'+this.$store.state.longitude+',"latitude":'+this.$store.state.latitude+"}}",contentType:"application/json",dataType:"json"}).then(function(s){t.shopAllInfo=s.data.result,t.shopAllInfoFlag=!0,0!==t.collectShopList.length&&t.collectShopList.filter(function(s,o,e){t.shopAllInfo.shopInfo.shopCode===s.shopCode&&(t.isCollect=!0)}),t.showvipcard()})},getShopDecoration:function(){var t=this;this.axios({method:"post",url:this.global.hftcomClient,data:'{"id":19,"jsonrpc":"2.0","method":"cGetShopDecoration","params":{"shopCode":"'+this.$route.params.shopCode+'","page":1}}',contentType:"application/json",dataType:"json"}).then(function(s){t.shopDecoList=s.data.result.shopDecoList;for(var o=i()(t.$data.shopDecoList).length,e=0;e<o;e++)t.$data.shopImgList[e]=t.shopDecoList[e].imgUrl})},getShopCollectList:function(){var t=this;this.axios({method:"post",url:this.global.hftcomShop,data:'{"id":19,"jsonrpc":"2.0","method":"collectShop","params":{"userCode":"'+this.$store.state.userCode+'","latitude":'+this.$store.state.latitude+',"longitude":'+this.$store.state.longitude+"}}",contentType:"application/json",dataType:"json"}).then(function(s){"null"!==s.data.result&&null!==s.data.result?t.$store.state.collectShopList=s.data.result[0]:t.$store.state.collectShopList=[]})},collectShop:function(t){var s=this;this.isLogin?this.axios({method:"post",url:this.global.hftcomShop,data:'{"id":19,"jsonrpc":"2.0","method":"showCollect","params":{"shopCode":"'+t+'","userCode":"'+this.$store.state.userCode+'","zoneId":"'+this.zoneId+'"}}',contentType:"application/json",dataType:"json"}).then(function(t){1===t.data.result?(s.isCollect=!0,s.$vux.toast.text("已收藏","bottom")):0===t.data.result?(s.isCollect=!1,s.$vux.toast.text("已取消收藏","bottom")):s.$vux.toast.text("数据错误，请稍后重试","bottom")}):(this.$store.state.isBLR=1,this.$store.state.showLoginBox=!0,this.$vux.toast.text("请登录","bottom"))},showvipcard:function(){var t=this;this.axios({method:"post",url:this.global.hftcomWeixinCard,data:'{"id":29,"jsonrpc":"2.0","method":"hasCard","params":{"userCode":"'+this.userCode+'","shopCode":"'+this.shopAllInfo.shopInfo.shopCode+'"}}'}).then(function(s){5e4===s.data.result.code?!1===s.data.result.state?t.viptype=0:t.viptype=s.data.result.state:t.$vux.toast.text(s.data.result.code,"bottom")})},getvipcard:function(){var t=this;this.isLogin?0===this.viptype?this.axios({method:"post",url:this.global.hftcomWeixinCard,data:'{"id":29,"jsonrpc":"2.0","method":"addCardUser","params":{"userCode":"'+this.userCode+'","shopCode":"'+this.shopAllInfo.shopInfo.shopCode+'"}}'}).then(function(s){if(console.log(s.data),5e4===s.data.result.code)switch(s.data.result.state){case!0:t.viptype=2,t.$vux.toast.text("领取成功","bottom"),t.addvipcard(t.shopAllInfo.shopInfo.shopCode);break;case!1:t.$vux.toast.text("领取失败，请重试","bottom");break;default:t.$vux.toast.text(s.data.result.state,"bottom")}else t.$vux.toast.text(s.data.result.code,"bottom")}):this.addvipcard(this.shopAllInfo.shopInfo.shopCode):(this.$store.state.isBLR=1,this.$store.state.showLoginBox=!0,this.$vux.toast.text("请登录","bottom"))},addvipcard:function(t){var s=this;this.isadding=t,this.axios({method:"post",url:this.global.hftcomWeixinCard,data:'{"id":29,"jsonrpc":"2.0","method":"addWeixinCard","params":{"userCode":"'+this.userCode+'","shopCode":"'+t+'"}}'}).then(function(t){console.log(t.data),""===t.data.result.signPakage||void 0===t.data.result.signPakage?s.$vux.toast.text("数据请求错误，请稍后重试","bottom"):(s.cardInfo=t.data.result.cardInfo,s.signPakage=t.data.result.signPakage,s.userCardCode=t.data.result.userCardCode,s.addcardtoweixin()),s.isadding=""})},updateUserWeixinCard:function(){var t=this;this.axios({method:"post",url:this.global.hftcomWeixinCard,data:'{"id":29,"jsonrpc":"2.0","method":"updateUserWeixinCard","params":{"userCardCode":"'+this.userCardCode+'"}}'}).then(function(s){t.viptype=1,t.$vux.toast.text("已添加","bottom")})},addcardtoweixin:function(){var t=this;wx.config({debug:!1,appId:this.signPakage.appid,timestamp:this.signPakage.timestamp,nonceStr:this.signPakage.noncestr,signature:this.signPakage.signature,jsApiList:["addCard"]}),wx.ready(function(){wx.addCard({cardList:[{code:t.cardInfo.code,cardId:t.cardInfo.card_id,cardExt:'{"code":"'+t.cardInfo.code+'","timestamp":"'+t.cardInfo.timestamp+'","signature":"'+t.cardInfo.signature+'","nonce_str":"'+t.cardInfo.nonce_str+'"}'}],success:function(s){t.updateUserWeixinCard()},cancel:function(s){t.$vux.toast.text("取消添加","bottom")}})}),wx.error(function(t){console.log("err",t)})}},created:function(){this.getShopCollectList(),this.getShopDetail(),this.getShopDecoration(),this.$store.dispatch("getCollectInfo")},components:{swiper:c.a,indexcoupon:p.a}}},351:function(t,s){},378:function(t,s){t.exports={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{attrs:{id:"shopdetail"}},[o("div",{staticClass:"album"},[o("header",{staticClass:"header"},[o("div",{staticClass:"header-item icon-back",on:{click:t.goBack}}),t._v(" "),o("div",{staticClass:"header-item"},[o("span",{directives:[{name:"show",rawName:"v-show",value:!1===t.isCollect,expression:"isCollect ===false"}],staticClass:"icon-collect",on:{click:function(s){t.collectShop(t.shopAllInfo.shopInfo.shopCode)}}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!0===t.isCollect,expression:"isCollect === true"}],staticClass:"icon-collect-solid theme-red",on:{click:function(s){t.collectShop(t.shopAllInfo.shopInfo.shopCode)}}})])]),t._v(" "),0!==t.shopImgList.length?o("swiper",{attrs:{imgSrcArr:t.shopImgList}}):t._e()],1),t._v(" "),o("div",{staticClass:"shopInfoWrapper"},[o("p",{staticClass:"shopName"},[t._v(t._s(t.shopAllInfo.shopInfo.shopName)+" "),o("span",{staticClass:"popularity"},[t._v("人气："+t._s(t.shopAllInfo.shopInfo.popularity))])]),t._v(" "),o("div",{staticClass:"shopInfo"},[o("div",{staticClass:"left"},[o("div",{staticClass:"clock"},[o("div",{staticClass:"icon icon-clock"}),t._v(" "),o("div",{staticClass:"clocktext"},t._l(t.shopAllInfo.shopInfo.businessHours,function(s){return o("p",[t._v(t._s(s.open)+"-"+t._s(s.close))])}))]),t._v(" "),o("div",{staticClass:"location"},[o("div",{staticClass:"icon icon-location"}),t._v(" "),o("div",{staticClass:"locationtext"},[o("p",[o("span",[t._v(t._s(t.shopAllInfo.shopInfo.city))]),o("span",[t._v(t._s(t.shopAllInfo.shopInfo.district))]),o("span",[t._v(t._s(t.shopAllInfo.shopInfo.street))])])])])]),t._v(" "),o("div",{staticClass:"right"},[o("div",{staticClass:"content"},[o("a",{attrs:{href:"tel:"+t.shopAllInfo.shopInfo.tel}},[o("p",{staticClass:"icon-phone"})])])])])]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:1!==t.viptype,expression:"viptype!==1"}],staticClass:"vipcard"},[o("div",{staticClass:"left"},[o("div",{staticClass:"logo"},[o("span",{directives:[{name:"show",rawName:"v-show",value:0===t.viptype,expression:"viptype===0"}]},[t._v("您有一张会员卡未领取!")]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:2===t.viptype,expression:"viptype===2"}]},[t._v("会员卡可添加到微信卡包!")])]),t._v(" "),o("div",{staticClass:"vipinfo"},[t._v("会员卡专享:九折优惠")])]),t._v(" "),o("div",{staticClass:"right",on:{click:t.getvipcard}},[o("span",{directives:[{name:"show",rawName:"v-show",value:0===t.viptype,expression:"viptype===0"}]},[t._v("领取会员卡")]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:2===t.viptype&&t.isadding!==t.shopAllInfo.shopInfo.shopCode,expression:"viptype===2 && isadding!==shopAllInfo.shopInfo.shopCode"}]},[t._v("添加会员卡")]),t._v(" "),o("transition",{attrs:{name:"rotate"}},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.isadding===t.shopAllInfo.shopInfo.shopCode,expression:"isadding===shopAllInfo.shopInfo.shopCode"}],staticClass:"icon-spinner8"})])],1)]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showmask,expression:"showmask"}],staticClass:"mask"}),t._v(" "),o("div",{staticClass:"shopCoupon"},[o("p",{staticClass:"name"},[t._v("优惠券")]),t._v(" "),0===t.shopAllInfo.couponList.shopCoupon.length?o("p",{staticClass:"text"},[t._v("本店暂无可领优惠券")]):t._e(),t._v(" "),t._l(t.shopAllInfo.couponList.shopCoupon,function(s){return t.shopAllInfoFlag?o("indexcoupon",{key:s.batchCouponCode,attrs:{index:s}}):t._e()})],2),t._v(" "),o("div",{staticClass:"shopdetail"},[o("p",{staticClass:"name"},[t._v("商家详情")]),t._v(" "),""===t.shopAllInfo.shopInfo.shortDes?o("p",{staticClass:"text"},[t._v("本店暂无商家详情")]):t._e(),t._v(" "),o("p",{staticClass:"content"},[t._v(t._s(t.shopAllInfo.shopInfo.shortDes))])])])},staticRenderFns:[]}}});
//# sourceMappingURL=6.c18e636f606d888316fa.js.map